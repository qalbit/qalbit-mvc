(()=>{(function(){"use strict";function _(u){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",u,{once:!0}):u()}_(function(){const u=typeof window.matchMedia=="function",a=u?window.matchMedia("(prefers-reduced-motion: reduce)"):null,s=!!(a&&a.matches),l=u?window.matchMedia("(min-width: 1024px)"):null,e=()=>l?l.matches:window.innerWidth>=1024,c=typeof window.gsap!="undefined",t=c?window.gsap:null;c&&typeof window.ScrollTrigger!="undefined"&&t.registerPlugin(window.ScrollTrigger),M({gsap:t,hasGsap:c,prefersReducedMotion:s}),j({gsap:t,hasGsap:c,prefersReducedMotion:s}),P({gsap:t,hasGsap:c,prefersReducedMotion:s}),D({gsap:t,hasGsap:c,prefersReducedMotion:s}),H(),R(),O(),F()});function M(u){const{gsap:a,hasGsap:s,prefersReducedMotion:l}=u,e=document.querySelector("[data-cta-section]");if(!e)return;if(!s||l){e.querySelectorAll("[data-cta-step]").forEach(i=>{i.style.opacity="1",i.style.transform="none"});const n=e.querySelector("[data-cta-connector]");n&&(n.style.transform="scaleX(1)");return}const c=Array.from(e.querySelectorAll("[data-cta-step]"));if(!c.length)return;const t=e.querySelector("[data-cta-connector]");let f=!1;function h(){if(f)return;f=!0;const r=a.timeline();t&&r.fromTo(t,{scaleX:0,autoAlpha:0},{scaleX:1,autoAlpha:1,duration:.6,ease:"power2.out"}),r.fromTo(c,{y:32,autoAlpha:0},{y:0,autoAlpha:1,duration:.6,ease:"power3.out",stagger:.18},t?"-=0.25":0)}"IntersectionObserver"in window?new IntersectionObserver(n=>{n.forEach(i=>{i.target===e&&i.isIntersecting&&h()})},{threshold:.35}).observe(e):h()}function j(u){const{gsap:a,hasGsap:s,prefersReducedMotion:l}=u,e=document.querySelector("[data-faq-section]");if(!e)return;const c=Array.from(e.querySelectorAll("[data-faq-item]")),t=Array.from(e.querySelectorAll("[data-faq-trigger]"));if(!c.length||!t.length)return;if(s&&!l){const n=e.querySelector("[data-faq-header]"),i=a.timeline({paused:!0});if(n&&i.from(n,{y:24,autoAlpha:0,duration:.35,ease:"power2.out"}),i.from(c,{y:24,autoAlpha:0,duration:.35,ease:"power2.out",stagger:.05},n?"-=0.1":0),"IntersectionObserver"in window){const o=new IntersectionObserver(v=>{v.forEach(y=>{y.target===e&&y.isIntersecting&&(i.play(),o.disconnect())})},{threshold:.2});o.observe(e)}else i.play()}const f=new WeakMap;function h(n,i){const o=n.querySelector("[data-faq-panel]"),v=n.querySelector("[data-faq-trigger]");if(!o||!v)return;const y=f.get(o);if(y&&y.kill(),n.classList.toggle("is-open",i),v.setAttribute("aria-expanded",i?"true":"false"),o.hidden=!1,!s||l){const d=i?o.scrollHeight+"px":"0px";o.style.maxHeight=d,i||setTimeout(()=>{o.hidden=!0},260);return}const E=o.offsetHeight,T=i?o.scrollHeight:0,k=a.fromTo(o,{height:E},{height:T,duration:.28,ease:"power2.out",onComplete:()=>{o.style.height="",i||(o.hidden=!0)}});f.set(o,k)}function r(n){const i=n.classList.contains("is-open");c.forEach(o=>{o!==n&&o.classList.contains("is-open")&&h(o,!1)}),h(n,!i)}c.forEach((n,i)=>{const o=n.querySelector("[data-faq-panel]"),v=n.querySelector("[data-faq-trigger]");if(!o||!v)return;o.style.overflow="hidden",o.style.maxHeight="none";const y=i===0;n.classList.toggle("is-open",y),v.setAttribute("aria-expanded",y?"true":"false"),y?(o.hidden=!1,o.style.height="auto"):(o.hidden=!0,o.style.height="0"),v.addEventListener("click",()=>r(n))})}function P(u){const{gsap:a,hasGsap:s,prefersReducedMotion:l}=u,e=document.querySelector("[data-blog-teaser]");if(!e)return;const c=e.querySelector("[data-blog-header]"),t=e.querySelector("[data-blog-cta]"),f=Array.from(e.querySelectorAll("[data-blog-card]"));if(!s||l||!f.length)return;c&&a.set(c,{y:18,autoAlpha:0}),t&&a.set(t,{y:18,autoAlpha:0}),a.set(f,{y:26,autoAlpha:0});let h=!1;function r(){if(h)return;h=!0;const n=a.timeline({defaults:{duration:.6,ease:"power3.out"}});c&&n.to(c,{y:0,autoAlpha:1},0),t&&n.to(t,{y:0,autoAlpha:1},.05),n.to(f,{y:0,autoAlpha:1,stagger:.12},.1)}if("IntersectionObserver"in window){const n=new IntersectionObserver(i=>{i.forEach(o=>{o.target===e&&o.isIntersecting&&(r(),n.disconnect())})},{threshold:.25});n.observe(e)}else r()}function D(u){const{gsap:a,hasGsap:s,prefersReducedMotion:l}=u,e=document.querySelector("[data-contact-cta-section]");if(!e)return;const c=e.querySelector("[data-contact-cta-left]"),t=Array.from(e.querySelectorAll("[data-contact-stat]")),f=e.querySelector("[data-contact-cta-form]");if(!s||l)return;c&&a.set(c,{autoAlpha:0,y:26}),f&&a.set(f,{autoAlpha:0,y:26}),t.length&&a.set(t,{autoAlpha:0,y:26});let h=!1;function r(){if(h)return;h=!0;const n=a.timeline({defaults:{duration:.65,ease:"power3.out"}});c&&n.to(c,{autoAlpha:1,y:0},0),f&&n.to(f,{autoAlpha:1,y:0},.08),t.length&&n.to(t,{autoAlpha:1,y:0,stagger:.1},.12)}if("IntersectionObserver"in window){const n=new IntersectionObserver(i=>{i.forEach(o=>{o.target===e&&o.isIntersecting&&(r(),n.disconnect())})},{threshold:.25});n.observe(e)}else r()}function B(u){const{isDesktop:a}=u,s=document.querySelector("[data-exit-popup]");if(!s)return;const l="qalbit_exit_popup_dismissed",e=(function(){try{const d="__exit_test";return window.sessionStorage.setItem(d,"1"),window.sessionStorage.removeItem(d),!0}catch(d){return!1}})();if(e&&sessionStorage.getItem(l)==="1")return;const c=s.querySelectorAll("[data-exit-close]"),t=s.querySelector("form"),f=2e4,h=.5;let r=!1;function n(){e&&sessionStorage.setItem(l,"1")}function i(){s.classList.remove("hidden"),s.setAttribute("aria-hidden","false"),document.documentElement.classList.add("overflow-hidden"),document.body.classList.add("overflow-hidden")}function o(){r||(r=!0),s.classList.add("hidden"),s.setAttribute("aria-hidden","true"),document.documentElement.classList.remove("overflow-hidden"),document.body.classList.remove("overflow-hidden"),n(),v()}function v(){window.removeEventListener("mouseout",k),window.removeEventListener("scroll",E,{passive:!0})}function y(d){r||(r=!0,v(),i())}if(c.forEach(function(d){d.addEventListener("click",function(S){S.preventDefault(),o()})}),s.addEventListener("click",function(d){d.target===s&&o()}),t){let S=function(m){d&&(m?(d.dataset.originalLabel||(d.dataset.originalLabel=d.textContent||"Send message"),d.disabled=!0,d.textContent="Sending..."):(d.disabled=!1,d.dataset.originalLabel&&(d.textContent=d.dataset.originalLabel)))},x=function(){let m=t.querySelector("[data-js-global-error]");m||(m=document.createElement("div"),m.setAttribute("data-js-global-error","true"),m.className="mb-3 hidden rounded-md border border-red-200 bg-red-50 px-4 py-3 text-xs text-red-800",t.prepend(m));let p=t.querySelector("[data-js-global-success]");p||(p=document.createElement("div"),p.setAttribute("data-js-global-success","true"),p.className="mb-3 hidden rounded-md border border-green-200 bg-green-50 px-4 py-3 text-xs text-green-800",t.prepend(p)),["name","email","message"].forEach(function(w){const b=t.querySelector(`[name="${w}"]`);if(!b)return;let g=t.querySelector(`[data-js-error-for="${w}"]`);g||(g=document.createElement("p"),g.setAttribute("data-js-error-for",w),g.className="mt-1 hidden text-[11px] text-red-600",b.insertAdjacentElement("afterend",g))})},q=function(){const m=t.querySelector("[data-js-global-error]");m&&(m.textContent="",m.classList.add("hidden"));const p=t.querySelector("[data-js-global-success]");p&&(p.textContent="",p.classList.add("hidden")),["name","email","message"].forEach(function(w){const b=t.querySelector(`[name="${w}"]`);b&&(b.classList.remove("border-red-400"),b.classList.add("border-slate-300"));const g=t.querySelector(`[data-js-error-for="${w}"]`);g&&(g.textContent="",g.classList.add("hidden"))})},I=function(m){if(x(),q(),!m)return;const p=t.querySelector("[data-js-global-error]");m.global&&p&&(p.textContent=m.global,p.classList.remove("hidden")),["name","email","message"].forEach(function(w){const b=m[w];if(!b)return;const g=t.querySelector(`[name="${w}"]`);g&&(g.classList.remove("border-slate-300"),g.classList.add("border-red-400"));const L=t.querySelector(`[data-js-error-for="${w}"]`);L&&(L.textContent=b,L.classList.remove("hidden"))})},V=function(m){x(),q();const p=t.querySelector("[data-js-global-success]");p&&(p.textContent=m||"Thank you. We have received your enquiry and will respond within 24 hours (business days).",p.classList.remove("hidden"))};const d=t.querySelector('button[type="submit"]');t.addEventListener("submit",function(m){m.preventDefault(),x(),q(),S(!0);const p=new FormData(t);p.set("ajax","1");const w=document.querySelector('meta[name="recaptcha-site-key"]'),b=w?w.getAttribute("content"):"",g=typeof window.grecaptcha!="undefined"&&b,L=function(C){C&&p.set("recaptcha_token",C),fetch(t.action,{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},body:p}).then(function(A){return A.json().catch(function(){return null})}).then(function(A){if(S(!1),!A){I({global:"Something went wrong. Please try again later."});return}A.success?(V(A.message),t.reset(),n(),v()):I(A.errors||{})}).catch(function(){S(!1),I({global:"We could not send your message right now. Please try again later."})})};g?window.grecaptcha.ready(function(){window.grecaptcha.execute(b,{action:"contact"}).then(function(C){L(C)}).catch(function(){S(!1),I({global:"We could not verify that you are a human. Please try again."})})}):L(null)})}window.setTimeout(function(){!r&&(!e||sessionStorage.getItem(l)!=="1")&&y("timer")},f);function E(){if(r){window.removeEventListener("scroll",E,{passive:!0});return}const d=document.documentElement,S=window.scrollY||d.scrollTop||0,x=window.innerHeight||d.clientHeight||0,q=d.scrollHeight||0;if(!q)return;(S+x)/q>=h&&y("scroll")}window.addEventListener("scroll",E,{passive:!0});const T=typeof a=="function"?a:function(){return window.innerWidth>=1024};function k(d){!T()||r||d.relatedTarget||d.toElement||d.clientY<=0&&y("exit-intent")}T()&&window.addEventListener("mouseout",k)}function H(){var u=document.querySelectorAll('form[data-track="contact-form"]');u.length&&u.forEach(function(a){var s=a.querySelector('input[name="name"]'),l=a.querySelector('input[name="email"]'),e=a.querySelector('textarea[name="message"]');if(!s||!l||!e)return;function c(r){var n=r.trim();return n?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n):!1}function t(r){if(r){r.classList.remove("border-red-400"),r.classList.contains("border-slate-300")||r.classList.add("border-slate-300");var n=r.closest(".space-y-1")||r.parentElement;if(n){var i=n.querySelector("[data-field-error]");i&&i.remove()}}}function f(r,n){if(r){r.classList.remove("border-slate-300"),r.classList.add("border-red-400");var i=r.closest(".space-y-1")||r.parentElement;if(i){var o=i.querySelector("[data-field-error]");o||(o=document.createElement("p"),o.setAttribute("data-field-error","true"),o.className="mt-1 text-[11px] text-red-600",i.appendChild(o)),o.textContent=n}}}function h(){var r=!1;t(s),t(l),t(e);var n=s.value.trim(),i=l.value.trim(),o=e.value.trim();return n||(f(s,"Please enter your name."),r=!0),i?c(i)||(f(l,"Please enter a valid email address."),r=!0):(f(l,"Please enter your email."),r=!0),(!o||o.length<20)&&(f(e,"Please add a few more details (at least 20 characters)."),r=!0),!r}a.addEventListener("submit",function(r){if(!h()){r.preventDefault();var n=a.querySelector("[data-field-error]");n&&typeof n.scrollIntoView=="function"&&n.scrollIntoView({block:"nearest"})}}),[s,l,e].forEach(function(r){r.addEventListener("input",function(){t(r)})})})}function R(){var u=document.querySelector("[data-cookie-banner]");if(!u)return;var a="qalbit_cookie_consent_v1";try{if(window.localStorage&&localStorage.getItem(a)==="accepted")return}catch(e){}u.classList.remove("hidden");var s=u.querySelector("[data-cookie-accept]");function l(){try{window.localStorage&&localStorage.setItem(a,"accepted")}catch(e){}u.classList.add("hidden"),window.dataLayer&&Array.isArray(window.dataLayer)&&window.dataLayer.push({event:"cookie_consent_accepted"})}s&&s.addEventListener("click",function(e){e.preventDefault(),l()})}function O(){if(typeof window.intlTelInput!="function"){console.warn("[intlTelInput] Library not available");return}var u=document.querySelectorAll("[data-intl-tel-input]");u.length&&u.forEach(function(a){if(!a.__itiInstance){var s=a.form||null,l=window.intlTelInput(a,{initialCountry:"auto",geoIpLookup:(e,c)=>{fetch("https://ipapi.co/json").then(t=>t.json()).then(t=>e(t.country_code)).catch(()=>c())},hiddenInput:e=>({phone:"phone_full",country:"country_code"}),separateDialCode:!0,nationalMode:!1,autoHideDialCode:!1,utilsScript:"https://cdn.jsdelivr.net/npm/intl-tel-input@25.12.5/build/js/utils.min.js"});a.__itiInstance=l,s&&s.addEventListener("submit",function(){try{l.isValidNumber()&&(a.value=l.getNumber())}catch(e){console.warn("[intlTelInput] Failed to normalize phone:",e)}})}})}function F(){var u=document.querySelector('[data-floating-stack="bottom-left"]');if(!u)return;var a=u.querySelector("[data-scroll-top-trigger]");if(!a)return;var s=400,l=80,e=!1;function c(){e||(e=!0,a.classList.remove("opacity-0","pointer-events-none","translate-y-2"),a.classList.add("opacity-100","pointer-events-auto","translate-y-0"))}function t(){e&&(e=!1,a.classList.add("opacity-0","pointer-events-none","translate-y-2"),a.classList.remove("opacity-100","pointer-events-auto","translate-y-0"))}window.addEventListener("scroll",function(){var f=window.pageYOffset||document.documentElement.scrollTop||0;f>s?c():f<l&&t()},{passive:!0}),a.addEventListener("click",function(){try{window.scrollTo({top:0,behavior:"smooth"})}catch(f){window.scrollTo(0,0)}})}})();})();
